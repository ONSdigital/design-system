# Migration Guide from version 70.x.x to 71.0.0

# Introduction

This document outlines the steps needed to migrate to version 71.0.0 of our Design System library from versions 70.x.x. This release includes several breaking-changes that may impact your projects. Please follow this guide to ensure a smooth transition.

## Global changes

This section will list the changes that will impact more than one component

### **_Standardisation of setting heading level across components_**

[**Link to PR**](https://github.com/ONSdigital/design-system/pull/3111)

-   **Description of change:** `titleTag` which usually expects a string like `h3` is being replace by a `headingLevel` which now expects an integer.
-   **Reason for change:** In this update, we are addressing an inconsistency in the components/patterns within our system. Some components use `titleTag` while others use `headingLevel` to set the HTML tag for titles/headings. This update aims to standardise the usage by migrating all components using `titleTag` to using `headingLevel`.

    It's important to note that while a default value is set for the heading level, this could be a breaking change as it may alter the heading level in existing use cases and that the new `headingLevel` param will need an integer from now on and not the whole tag.

-   **Components impacted:**

    -   accordion
    -   details
    -   document-list
    -   panel
    -   share-page
    -   tabs
    -   timeline

-   **Migration steps:**

    1. Locate all instances of `titleTag` in your codebase.
    2. Replace `titleTag` with `headingLevel` and replace the heading tag you had with the relevant integer like below

    -   <details>
            <summary><b>Click for example:</b></summary>

                ```njk
                OLD
                {{
                    onsTimeline({
                        "titleTag": "h3"
                    })
                }}

                NEW
                {{
                    onsTimeline({
                        "headingLevel" : 3
                    })
                }}
                ```

        </details>

### **_Update parameter names to camel case naming standard_**

[**Link to PR**](https://github.com/ONSdigital/design-system/pull/3188)

-   **Description of change:** Many parameter names have been updated.
-   **Reason for change:** Updated various parameters to use the camel case naming standard.

    This will be a breaking change and will require the renaming of some parameters for the following components and parameters:

-   **Components impacted:**

    -   Card - `image.placeholderURL` will need to be renamed `image.placeholderUrl`
    -   Cookies Banner - `settingsLinkTextURL` will need to be renamed `settingsLinkTextUrl`
    -   Header - `logo.logoURL` will need to be renamed `logo.logoUrl`
    -   Header - `ISOCode` will need to be renamed `isoCode`
    -   Header - `navigation.subNavigation.overviewURL` will need to be renamed `navigation.subNavigation.overviewUrl`
    -   Share Page -`pageURL` will need to be renamed `pageUrl`
    -   Video - `videoLinkURL` will need to be renamed `videoLinkUrl`
    -   Page Template - `assetsURL` will need to be renamed `assetsUrl`
    -   Footer - `OGLLink` will need to be renamed `oglLink`
    -   Message - `messageID` will need to be renamed `messageId`
    -   Access Code - `maxlength` will need to be renamed `maxLength`
    -   Address input - `APIDomain` will need to be renamed `apiDomain`
    -   Address input - `APIDomainBearerToken` will need to be renamed `apiDomainBearerToken`
    -   Address input - `APIManualQueryParams` will need to be renamed `apiManualQueryParams`
    -   Address input - `errorMessageAPI` will need to be renamed `errorMessageApi`
    -   Address input - `errorMessageAPILinkText` will need to be renamed `errorMessageApiLinkText`

-   **Migration steps:**

    1. Locate all instances of the above parameters in your codebase.
    2. Replace `oldParameter` with `newParameter`.

    -   <details>
            <summary><b>Click for example:</b></summary>

                ```njk
                OLD
                {{
                    onsHeader({
                        "title": 'Page title',
                        "mastheadLogoUrl": {
                            "multipleLogos": {
                                "logo1": {
                                    "logoURL" : "https..."
                                }
                            }
                        },
                        "titleUrl": '#0',
                        "language": {
                            "languages": [
                                {
                                    "url": '#0',
                                    "ISOCode": 'en',
                                    "text": 'English',
                                    "current": true
                                },
                                {
                                    "url": '#0',
                                    "ISOCode": 'cy',
                                    "text": 'Cymraeg',
                                    "current": false
                                }
                            ]
                        },
                        "navigation": {
                            "subNavigation": {
                                "overviewURL": "https..."
                            }
                        }
                    })
                }}
                NEW
                {{
                    onsHeader({
                        "title": 'Page title',
                        "mastheadLogoUrl": {
                            "multipleLogos": {
                                "logo1": {
                                    "logoUrl" : "https..."
                                }
                            }
                        },
                        "titleUrl": '#0',
                        "language": {
                            "languages": [
                                {
                                    "url": '#0',
                                    "isoCode": 'en',
                                    "text": 'English',
                                    "current": true
                                },
                                {
                                    "url": '#0',
                                    "isoCode": 'cy',
                                    "text": 'Cymraeg',
                                    "current": false
                                }
                            ]
                        },
                        "navigation": {
                            "subNavigation": {
                                "overviewUrl": "https..."
                            }
                        }
                    })
                }}
                ```

        </details>

## Components

This section will list all the changes that are specific to one component.

### **_Call to action_**

**Remove call to action component and all references**

[**Link to PR**](https://github.com/ONSdigital/design-system/pull/3143)

-   **Description of change:** The `onsCallToAction` component has been removed.
-   **Reason for change:** The component was removed as it was only developed for use on the Census website.
-   **Migration steps:**

    1. Locate all instances of `onsCallToAction` in your codebase.
    2. You could update any instance of `onsCallToAction` with `onsButton`. The `onsButton` component is not a replacement for the `onsCallToAction` component so transition will not be like for like.

    -   <details>
          <summary><b>Click for example:</b></summary>

        ```njk
        OLD
        {% from "components/call-to-action/_macro.njk" import onsCallToAction %}

            {{-
                onsCallToAction({
                    "headingText": 'Call to action heading.',
                    "paragraphText": 'Descriptive text about call to action',
                    "button": {
                        "text": 'Start',
                        "url": '#0'
                    }
                })
            }}
        Suggested replacement
        {% from "components/button/_macro.njk" import onsButton %}

            {{
                onsButton({
                    "text": 'Get started',
                    "url": '#0'
                })
            }}
        ```

          </details>

### **_Footer_**

**Add option for additional logo in footer**

[**Link to PR**](https://github.com/ONSdigital/design-system/pull/3227)

-   **Description of change:** The `poweredBy` parameter has been removed in favour of `footerLogo`.
-   **Reason for change:** This updates the footer component to support an additional logo, allowing for two logos instead of just one. It introduces the `link` param for each logo and offers an alternative layout option to display the logos on opposite sides of the footer. The default layout positions the logos next to each other. Additionally, the implementation is aligned with the header component's multipleLogo feature to ensure consistency across the application. The focus and hover states are also adjusted to avoid extra underlines and to ensure the highlight colour wraps only the SVG.
-   **Migration steps:**
    1. Locate all instances of `poweredBy` in your codebase.
    2. Replace `poweredBy` with `footerLogo`.
    -   <details>
          <summary><b>Click for example:</b></summary>
          
          ```njk
              OLD
              {{
                  onsFooter({
                      "poweredBy": "<svg></svg>"
                  })
              }}
              NEW
              {{
                  onsFooter({
                      "footerLogo": {
                          "logos": {
                              "logo1": {
                                  "logoImage": '<svg></svg>',
                                  "logoUrl": "#0"
                              },
                          }
                      }
                  })
              }}
          ```
          </details>

### **_Summary_**

**Rename summary component parameters**

[**Link to PR**](https://github.com/ONSdigital/design-system/pull/3224)

-   **Description of change:**
    -   `summary.summaryTitle` is renamed to `summary.title`
    -   `group.groupTitle` is renamed to `group.title`
    -   `row.rowTitle` is renamed to `row.title`
    -   `row.rowItems` is renamed to `row.items`
    -   `rowItem.rowTitle` is renamed to `item.title`
    -   `rowItem.rowTitleAttributes` is renamed to `item.titleAttributes`
-   **Reason for change:** In this update, we are addressing an inconsistency in the naming of parameters within the summary component. This change aims to standardise the parameter names for clarity and consistency.
-   **Migration steps:**

    1. Locate all instances of the above parameters in your codebase.
    2. Replace old parameters with new parameters as per below example.

    -   <details>
          <summary><b>Click for example:</b></summary>

        ```njk
        OLD
        {{
            onsSummary({
                "summaries": [
                    {
                        "groups": [
                            {
                                "placeholderText": 'test',
                                "id": "turnover",
                                "groupTitle": "Turnover",
                                "rows": [
                                    {
                                        "id": "sales-dates-row",
                                        "rowTitle": "What are the dates of the sales period you are reporting for?",
                                        "rowItems": [
                                            {
                                                "id": "sales-dates",
                                                "valueList": [
                                                    {
                                                        "text": "1 January 2015 to 2 February 2017"
                                                    }
                                                ],
                                                "actions": [
                                                    {
                                                        "text": "Change",
                                                        "visuallyHiddenText": "Change answer",
                                                        "url": "#0"
                                                    }
                                                ]
                                            }
                                        ]
                                    }
                                ]
                            }
                        ]
                    }
                ]
            })
        }}
        NEW
        {{
            onsSummary({
                "summaries": [
                    {
                        "groups": [
                            {
                                "placeholderText": 'test',
                                "id": "turnover",
                                "title": "Turnover",
                                "rows": [
                                    {
                                        "id": "sales-dates-row",
                                        "title": "What are the dates of the sales period you are reporting for?",
                                        "items": [
                                            {
                                                "id": "sales-dates",
                                                "valueList": [
                                                    {
                                                        "text": "1 January 2015 to 2 February 2017"
                                                    }
                                                ],
                                                "actions": [
                                                    {
                                                        "text": "Change",
                                                        "visuallyHiddenText": "Change answer",
                                                        "url": "#0"
                                                    }
                                                ]
                                            }
                                        ]
                                    }
                                ]
                            }
                        ]
                    }
                ]
            })
        }}
        ```

          </details>

### **_Timeline_**

**Refactor timeline macro for compatibility with Jinja2 templates**

[**Link to PR**](https://github.com/ONSdigital/design-system/pull/3180)

-   **Description of change:** We have made a breaking change to the timeline macro by renaming the `items` parameter to `timelineItems`.
-   **Reason for change:** The reason the parameter is being renamed is to fix a bug which takes place in Jinja environments where "items" is a reserved word.
-   **Migration steps:**

    1. Locate all instances of `items` in your codebase within the timeline component.
    2. Replace `items` with `timelineItems`.

    -   <details>
            <summary><b>Click for example:</b></summary>

            ```njk
            OLD
            {{
                onsTimeline({
                    "items": [. . . ],
                    "titleTag": "h3"
                })
            }}
            NEW
            {{
                onsTimeline({
                    "timelineItems": [. . . ],
                    "headingLevel" : 3
                })
            }}
            ```

        </details>

## Contact Information

For further assistance, please reach out to our support team:

-   **Email:** ons.design.system@ons.gov.uk
