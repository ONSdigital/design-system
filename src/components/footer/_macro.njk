{% macro onsFooter(params) %}
    {% from "components/lists/_macro.njk" import onsList %}

    {% if params.lang %}
        {% set lang = params.lang %}
    {% else %}
        {% set lang = 'en' %}
    {% endif %}

    {% if params.poweredByONS %}
        {% if params.poweredByONS.alt %}
            {% set poweredByAlt = params.poweredByONS.alt %}
        {% else %}
            {% set poweredByAlt = 'Office for National Statistics' %}
        {% endif %}
    {% endif %}

    {% set poweredByONSLogo %}
        <img src="/img/ons-logo-black-{{ lang }}.svg" alt="{{ poweredByAlt }}" class="footer__poweredby-img">
    {% endset %}
<<<<<<< HEAD
=======

    <footer class="footer {{ params.classes }}" data-analytics="footer" {% if params.attributes %}{% for attribute, value in (params.attributes) %}{{attribute}}="{{value}}" {% endfor %}{% endif %}>
        <div class="container">
            <div class="grid">
                {% if params.poweredByONS %}
                    {% if params.OGLLink %}
                        <div class="grid__col u-mb-m">
                            {{ poweredByONSLogo | safe }}
                        </div>
                    {% endif %}
                {% endif %}
                {% if params.button %}
                    {% from "components/button/_macro.njk" import onsButton %}
                    <div class="grid__col u-mb-m u-d-no@m">
                        {{
                            onsButton({
                                "id": params.button.id,
                                "type": params.button.type,
                                "classes": "btn--ghost-blue" + (" " + params.button.classes if params.button.classes else ""),
                                "text": params.button.text,
                                "html": params.button.html,
                                "name": params.button.name,
                                "value": params.button.value,
                                "attributes": params.button.attributes,
                                "url": params.button.url
                            })
                        }}
                    </div>
                {% endif %}
                {% if params.language %}
                        {% set currentLanguage = params.language.languages | selectattr("current") | first %}
                        <div class="grid__col u-d-no@m">
                            {% set languageItems = params.language.languages | rejectattr("current") %}
                            {% if currentLanguage.allLanguages and params.language.allLanguagesUrl %}
                                {% set languageItems = (languageItems.push({
                                    "url": params.language.allLanguagesUrl,
                                    "text": currentLanguage.allLanguages,
                                    "lang": currentLanguage.ISOCode
                                }), languageItems) %}
                            {% endif %}
                            {{
                                onsList({
                                    "classes": 'list--bare list--inline@s u-mb-no',
                                    "itemsList": languageItems
                                })
                            }}
                        </div>
                        <div class="grid__col u-d-no@m u-mt-m u-mb-m">
                            <hr class="footer__hr">
                        </div>
                {% endif %}
>>>>>>> 3b97973b0dbb7dd5e7712a54a01117ecf6c12ad1

    <footer class="footer {{ params.classes }}" data-analytics="footer" {% if params.attributes %}{% for attribute, value in (params.attributes) %}{{attribute}}="{{value}}" {% endfor %}{% endif %}>
        <div class="footer__body">
            <div class="container">
                <div class="grid">          
                    {% if params.poweredByONS %}
                        {% if params.OGLLink %}
                            <div class="grid__col u-mb-m">
                                {{ poweredByONSLogo | safe }}
                            </div>
                        {% endif %}
                    {% endif %}
                    {% if params.button %}
                        {% from "components/button/_macro.njk" import onsButton %}
                        <div class="grid__col u-mb-m u-d-no@m">
                            {{
                                onsButton({
                                    "id": params.button.id,
                                    "type": params.button.type,
                                    "classes": "btn--ghost-blue" + (" " + params.button.classes if params.button.classes else ""),
                                    "text": params.button.text,
                                    "html": params.button.html,
                                    "name": params.button.name,
                                    "value": params.button.value,
                                    "attributes": params.button.attributes,
                                    "url": params.button.url
                                })
                            }}
                        </div>
<<<<<<< HEAD
                    {% endif %}
                    {% if params.language %}
                            {% set currentLanguage = params.language.languages | selectattr("current") | first %}
                            <div class="grid__col u-d-no@m">
                                {% set languageItems = params.language.languages | rejectattr("current") %}
                                {% if currentLanguage.allLanguages and params.language.allLanguagesUrl %}
                                    {% set languageItems = (languageItems.push({
                                        "url": params.language.allLanguagesUrl,
                                        "text": currentLanguage.allLanguages,
                                        "lang": currentLanguage.ISOCode
                                    }), languageItems) %}
=======
                        <div class="grid__col u-d-no@m u-mb-m">
                            <hr class="footer__hr">
                        </div>
                {% endif %}

                {% if params.cols %}
                        {% for col in params.cols %}
                            <div class="grid__col col-4@m{{ " u-mt-m@xs@m" if loop.index > 1 }}">
                                {% if col.title %}
                                    <h4 class="u-fs-r--b footer__heading">{{ col.title }}</h4>
>>>>>>> 3b97973b0dbb7dd5e7712a54a01117ecf6c12ad1
                                {% endif %}
                                {{
                                    onsList({
                                        "classes": 'list--bare list--inline@s u-mb-no',
                                        "itemsList": languageItems
                                    })
                                }}
                            </div>
<<<<<<< HEAD
                            <div class="grid__col u-d-no@m u-mt-m u-mb-m">
                                <hr class="footer__hr">
                            </div>
                    {% endif %}

                    {% if params.serviceLinks %}
                            <div class="grid__col u-d-no@m">
                                {{
                                    onsList({
                                        "classes": 'list--bare list--inline u-mb-no',
                                        "itemsList": params.serviceLinks.itemsList
                                    })
                                }}
                            </div>
                            <div class="grid__col u-d-no@m u-mt-m u-mb-m">
                                <hr class="footer__hr">
                            </div>
                    {% endif %}

                    {% if params.cols %}
                            {% for col in params.cols %}
                                <div class="grid__col col-4@m{{ " u-mt-m@xs@m" if loop.index > 1 }}">
                                    {% if col.title %}
                                        <h4 class="u-fs-r--b footer__heading">{{ col.title }}</h4>
                                    {% endif %}
                                    {{
                                        onsList({
                                            "classes": 'list--bare u-mb-no',
                                            "itemsList": col.itemsList
                                        })
                                    }}
                                </div>
                            {% endfor %}
                    {% endif %}
                    {% if params.rows %}
                        {% for row in params.rows %}
                            {% if not params.OGLLink %}
                                {% if loop.last %}
                                    </div>
                                    <div class="grid grid--flex grid--vertical-center grid--between">
                                {% endif %}
                            {% endif %}
                            <div class="grid__col {% if loop.last %} u-mb-s u-mr-m{% endif %}">
                                {{
                                    onsList({
                                        "classes": 'list--bare list--inline@s u-mb-no',
                                        "itemsList": row.itemsList
                                    })
                                }}
                            </div>
                            {% if not params.OGLLink %}
                                {% if loop.last %}
                                    <div class="grid__col grid__col--flex u-ml-s u-mb-s u-p-no">
                                        {{ poweredByONSLogo | safe }}
                                    </div>
                                {% endif %}
                            {% endif %}
                            {% if loop.length > 1 %}                            
                                {% if not loop.last %}
                                    <div class="grid__col u-mb-m">
                                        <hr class="footer__hr">
                                    </div>
                                {% endif %}
                            {% endif %}
                        {% endfor %}                      
                    {% endif %}
										{% if params.OGLLink %}		
                        <div class="grid__col u-mb-m">
                            <hr class="footer__hr">
                        </div>
                        <div class="grid__col">
                            <div class="footer__license">
                                <img alt="OGL" class="footer__ogl-img" src="{{ params.assetsURL }}/img/UKOpenGovernmentLicence-grey.svg">
                                {% if params.OGLLink.HTML %}
                                    {{ params.OGLLink.HTML | safe }}
                                {% else %}
                                    {{ params.OGLLink.pre }} <a href="{{ params.OGLLink.url }}" class="footer__link">{{ params.OGLLink.link }}</a>{{ params.OGLLink.post }}
                                {% endif %}
                            </div>
                        </div>
                    {% elif params.poweredByONS and params.cols %}
                        <div class="grid__col u-mb-m">
                            <hr class="footer__hr">
                        </div>
                        <div class="grid__col u-mb-m">
                            {{ poweredByONSLogo | safe }}
                        </div>
                    {% endif %}
                </div>
=======
                        {% endfor %}
                {% endif %}
                {% if params.rows %}
                    {% for row in params.rows %}
                        {% if not params.OGLLink %}
                            {% if loop.last %}
                                </div>
                                <div class="grid grid--flex grid--vertical-center grid--between">
                            {% endif %}
                        {% endif %}
                        <div class="grid__col {% if loop.last %} u-mb-s u-mr-m{% endif %}">
                            {{
                                onsList({
                                    "classes": 'list--bare list--inline@s u-mb-no',
                                    "itemsList": row.itemsList
                                })
                            }}
                        </div>
                        {% if not params.OGLLink %}
                            {% if loop.last %}
                                <div class="grid__col grid__col--flex u-ml-s u-mb-s u-p-no">
                                    {{ poweredByONSLogo | safe }}
                                </div>
                            {% endif %}
                        {% endif %}
                        {% if loop.length > 1 %}                            
                            {% if not loop.last %}
                                <div class="grid__col u-mb-m">
                                    <hr class="footer__hr">
                                </div>
                            {% endif %}
                        {% endif %}
                    {% endfor %}                      
                {% endif %}
                {% if params.feedback %}
                    {% from "components/feedback/_macro.njk" import onsFeedback %}
                    <div class="grid__col col-8@m u-mb-s">
                        {{
                            onsFeedback({
                                "id": params.feedback.id | default("feedback"),
                                "action": params.feedback.action,
                                "title": params.feedback.title,
                                "closeButton":{
                                    "text": params.feedback.closeButton.text,
                                    "classes":  "btn--ghost-blue" + (" " + params.feedback.closeButton.classes if params.feedback.closeButton.classes else ""),
                                    "attributes": params.feedback.closeButton.attributes
                                },
                                "textarea": params.feedback.textarea,
                                "name": params.feedback.name,
                                "email": params.feedback.email,
                                "sendButton": params.feedback.sendButton,
                                "thankYouMessage": params.feedback.thankYouMessage,
                                "errorMessage": params.feedback.errorMessage,
                                "summaryAttributes": params.feedback.summaryAttributes
                            })
                        }}
                    </div>
                    <div class="grid__col u-mb-m">
                        <hr class="footer__hr">
                    </div>
                {% endif %}
                {% if params.OGLLink %}
                    <div class="grid__col u-mb-m">
                        <hr class="footer__hr">
                    </div>
                    <div class="grid__col">
                        <div class="footer__license">
                            <img alt="OGL" class="footer__ogl-img" src="{{ params.assetsURL }}/img/UKOpenGovernmentLicence-grey.svg">
                            {% if params.OGLLink.HTML %}
                                {{ params.OGLLink.HTML | safe }}
                            {% else %}
                                {{ params.OGLLink.pre }} <a href="{{ params.OGLLink.url }}" class="footer__link">{{ params.OGLLink.link }}</a>{{ params.OGLLink.post }}
                            {% endif %}
                        </div>
                    </div>
                {% elif params.poweredByONS and params.cols %}
                    <div class="grid__col u-mb-m">
                        <hr class="footer__hr">
                    </div>
                    <div class="grid__col u-mb-m">
                        {{ poweredByONSLogo | safe }}
                    </div>
                {% endif %}
>>>>>>> 3b97973b0dbb7dd5e7712a54a01117ecf6c12ad1
            </div>
        </div>
    </footer>
{% endmacro %}
