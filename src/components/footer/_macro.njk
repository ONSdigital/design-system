{% macro onsFooter(params) %}

    {% from "components/lists/_macro.njk" import onsList %}
    {% from "components/icons/_macro.njk" import onsIcon %}

    {% if params.lang is defined and params.lang %}
        {% set lang = params.lang %}
    {% else %}
        {% set lang = 'en' %}
    {% endif %}

    {% set onsLogo %}
        {% if params.lang == 'cy' %}
            {{
                onsIcon({
                    "iconType": 'ons-logo-cy',
                    "altText": 'Swyddfa Ystadegau Gwladol',
                    "altTextId": 'ons-logo-cy-footer-alt'
                })
            }}
        {% else %}
            {{
                onsIcon({
                    "iconType": 'ons-logo-en',
                    "altText": 'Office for National Statistics',
                    "altTextId": 'ons-logo-en-footer-alt'
                })
            }}
        {% endif %}
    {% endset %}

    {% set poweredByLogo %}
        {% if params.poweredBy is defined and params.poweredBy and params.poweredBy.logo is defined and params.poweredBy.logo %}
            {{
                onsIcon({
                    "iconType": params.poweredBy.logo,
                    "altText": params.poweredBy.alt,
                    "altTextId": 'poweredby-alt'
                })
            }}
        {% else %}
            {{ onsLogo | safe }}
        {% endif %}
    {% endset %}

    <footer class="ons-footer">

        {% if params.footerWarning is defined and params.footerWarning %}
            {% from "components/panel/_macro.njk" import onsPanel %}
            <div class="ons-footer__warning">
                <div class="ons-container">
                    {% call onsPanel({
                            "type": "warn",
                            "classes": "ons-panel--warn--footer"
                        })
                    %}
                        {{ params.footerWarning | safe }}
                    {% endcall %}
                </div>
            </div>
        {% endif %}

        {% if params.button is defined and params.button %}
            {% from "components/button/_macro.njk" import onsButton %}
            <div class="ons-footer__button-container ons-u-d-no@m">
                {{
                    onsButton({
                        "id": params.button.id,
                        "type": params.button.type,
                        "classes": params.button.classes if params.button.classes else "",
                        "variants": "ghost",
                        "text": params.button.text,
                        "html": params.button.html,
                        "name": params.button.name,
                        "value": params.button.value,
                        "attributes": params.button.attributes,
                        "url": params.button.url,
                        "buttonStyle": params.button.buttonStyle,
                        "iconType": params.button.iconType,
                        "iconPosition": params.button.iconPosition
                    })
                }}
            </div>
        {% endif %}

        <div class="ons-footer__body{{ ' ' + params.classes if params.classes else '' }}" data-analytics="footer" {% if params.attributes is defined and params.attributes %}{% for attribute, value in (params.attributes) %}{{attribute}}="{{value}}" {% endfor %}{% endif %}>
            <div class="ons-container{{ ' ons-container--wide' if params.wide }}">
                <div class="ons-grid">
                    {% if params.newTabWarning is defined and params.newTabWarning %}
                        <div class="ons-grid__col">
                            <p class="ons-u-fs-s ons-u-mb-m ons-footer__new-tab-warning">{{ params.newTabWarning | safe }}</p>
                        </div>
                    {% endif %}

                    {% if params.cols is defined and params.cols %}
                        {% for col in params.cols %}
                            <!-- Full footer columns -->
                            <div class="ons-grid__col ons-col-4@m{{ ' ons-u-mt-m@xxs@m' if loop.index > 1 }}">
                                {% if col.title %}
                                    <h2 class="ons-footer__heading ons-u-fs-r--b">{{ col.title }}</h2>
                                {% endif %}
                                {{
                                    onsList({
                                        "classes": 'ons-u-mb-no',
                                        "variants": 'bare',
                                        "itemsList": col.itemsList
                                    })
                                }}
                            </div>
                        {% endfor %}
                    {% elif params.rows is defined and params.rows %}
                        {% for row in params.rows %}
                            <!-- Transactional footer row -->
                            <div class="ons-grid__col">
                                {{
                                    onsList({
                                        "classes": "ons-footer--rows",
                                        "variants": ["bare", "inline"],
                                        "itemsList": row.itemsList
                                    })
                                }}
                            </div>
                        {% endfor %}
                    {% endif %}

                    {% if (params.cols is defined and params.cols) or (params.rows is defined and params.rows) %}
                        <div class="ons-grid__col ons-u-mb-m">
                            <hr class="ons-footer__hr">
                        </div>
                    {% endif %}

                </div>

                    <div class="ons-grid ons-grid--flex ons-grid--vertical-top ons-grid--between">
                        <div class="ons-grid__col">
                            {% if params.legal is defined and params.legal %}
                                <!-- Legal -->
                                {% for legal in params.legal %}
                                    {{
                                        onsList({
                                            "classes": 'ons-u-mb-s ons-footer--rows',
                                            "variants": ['bare', 'inline'],
                                            "itemsList": legal.itemsList
                                        })
                                    }}
                                {% endfor %}
                            {% endif %}

                            {% if params.OGLLink == true or params.OGLLink is defined %}
                                <!-- OGL -->
                                <div class="ons-footer__license ons-u-mb-m">
                                    {{
                                        onsIcon({
                                            "iconType": 'ogl'
                                        })
                                    }}
                                    {% if params.OGLLink.HTML is defined and params.OGLLink.HTML %}
                                        {{ params.OGLLink.HTML | safe }}
                                    {% elif params.OGLLink == true or params.OGLLink is defined %}
                                        {% from "components/external-link/_macro.njk" import onsExternalLink %}
                                        {% if params.lang == 'cy' %}
                                            {{ params.OGLLink.pre | default('Maeâ€™r holl gynnwys ar gael o dan y') }} {{
                                            onsExternalLink({
                                                "url": params.OGLLink.url | default('https://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/'),
                                                "linkText": params.OGLLink.link | default('Drwydded Llywodraeth Leol v3.0')
                                            })
                                            }}{{ params.OGLLink.post | default(', oni bai y nodir fel arall') }}
                                        {% else %}
                                            {{ params.OGLLink.pre | default('All content is available under the') }} {{
                                                onsExternalLink({
                                                    "url": params.OGLLink.url | default('https://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/'),
                                                    "linkText": params.OGLLink.link | default('Open Government Licence v3.0')
                                                })
                                            }}{{ params.OGLLink.post | default(', except where otherwise stated') }}
                                        {% endif %}
                                    {% endif %}
                                </div>
                            {% endif %}

                            {% if not params.poweredBy.partnership %}
                                <div class="ons-footer__poweredby ons-u-mb-m">
                                    {{ poweredByLogo | safe }}
                                </div>
                            {% endif %}
                        </div>

                        {% if params.crest is defined and params.crest %}
                            <!-- Crest -->
                            <div class="ons-grid__col ons-footer__crest ons-u-mb-m@xxs@l">
                                {{
                                    onsIcon({
                                        "iconType": 'crest'
                                    })
                                }}
                            </div>
                        {% endif %}
                    </div>

                {% if (params.poweredBy is defined and params.poweredBy) and (params.poweredBy.partnership is defined and params.poweredBy.partnership) %}
                    <div class="ons-grid ons-grid--flex ons-grid--vertical-bottom ons-grid--between ons-u-mt-l">
                        <div class="ons-grid__col ons-footer__poweredby ons-u-mb-m">
                            {{ poweredByLogo | safe }}
                        </div>

                        <div class="ons-grid__col ons-footer__partnership ons-u-mb-m">
                            <div class="ons-footer__partnership-prefix">{{ params.poweredBy.partnership }}</div>
                            {% if params.lang == 'cy' %}
                                {{
                                    onsIcon({
                                        "iconType": 'ons-logo-cy',
                                        "altText": 'Swyddfa Ystadegau Gwladol',
                                        "altTextId": 'ons-logo-cy-footer-alt'
                                    })
                                }}
                            {% else %}
                                {{
                                    onsIcon({
                                        "iconType": 'ons-logo-en',
                                        "altText": 'Office for National Statistics',
                                        "altTextId": 'ons-logo-en-footer-alt'
                                    })
                                }}
                            {% endif %}
                        </div>
                    </div>
                {% endif %}

                {% if params.copyrightDeclaration is defined and params.copyrightDeclaration %}
                <!-- Copyright -->
                <div class="ons-grid">
                    <div class="ons-grid__col">
                        <p class="ons-u-fs-s ons-u-mb-no ons-footer__copyright">&copy; {{ params.copyrightDeclaration.copyright }} <br> {{ params.copyrightDeclaration.text }}</p>
                    </div>
                </div>
                {% endif %}
            </div>
        </div>
    </footer>

{% endmacro %}
