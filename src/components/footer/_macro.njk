{% macro onsFooter(params) %}
  {% from "components/lists/_macro.njk" import onsList %}

  {% if params.lang %}
      {% set lang = params.lang %}
  {% else %}
      {% set lang = 'en-GB' %}
  {% endif %}

  {% if params.poweredByONS %}
      {% if params.poweredByONS.alt %}
          {% set poweredByAlt = params.poweredByONS.alt %}
      {% else %}
          {% set poweredByAlt = 'Office for National Statistics' %}
      {% endif %}
  {% endif %}

  <footer class="footer {{ params.classes }}" role="contentinfo">
      <div class="container">
          <div class="grid">
              {% if params.poweredByONS %}
                  <div class="grid__col u-mb-m">
                      <img src="/img/ons-logo-black-{{ lang }}.svg" alt="{{ poweredByAlt }}" class="footer__poweredby-img">
                  </div>
              {% endif %}
              {% if params.button %}
                  {% from "components/button/_macro.njk" import onsButton %}
                  <div class="grid__col u-mb-m u-d-no@m">
                      {{
                          onsButton({
                              "id": params.button.id,
                              "type": params.button.type,
                              "classes": "btn--ghost-blue" + (" " + params.button.classes if params.button.classes),
                              "text": params.button.text,
                              "html": params.button.html,
                              "name": params.button.name,
                              "value": params.button.value,
                              "attributes": params.button.attributes
                          })
                      }}
                  </div>
              {% endif %}
              {% if params.language %}
                  {% set currentLanguage = params.language.languages | selectattr("current") | first %}
                  <div class="grid__col u-d-no@m">
                      {% set languageItems = params.language.languages | rejectattr("current") %}
                      {% if currentLanguage.allLanguages and params.language.allLanguagesUrl %}
                          {% set languageItems = (languageItems.push({ 
                              "url": params.language.allLanguagesUrl,
                              "text": currentLanguage.allLanguages,
                              "lang": currentLanguage.ISOCode 
                          }), languageItems) %}
                      {% endif %}
                      {{
                          onsList({ 
                              "classes": 'list--bare list--inline@s u-mb-no',
                              "items": languageItems
                          })
                      }}
                  </div>
                  <div class="grid__col u-d-no@m u-mt-m u-mb-m">
                      <hr class="footer__hr">
                  </div>
              {% endif %}
            
              {% if params.cols %}
                  {% for col in params.cols %}
                      <div class="grid__col col-4@m{{ " u-mt-m@xs@m" if loop.index > 1 }}">
                          {% if col.title %}
                              <h4 class="u-fs-r--b footer__heading">{{ col.title }}</h4>
                          {% endif %}
                          {{
                              onsList({
                                  "classes": 'list--bare u-mb-no',
                                  "items": col.items
                              })
                          }}
                      </div>
                  {% endfor %}
                  <div class="grid__col u-mt-m u-mb-m">
                      <hr class="footer__hr">
                  </div>
              {% endif %}
              {% if params.rows %}
                  {% for row in params.rows %}
                      <div class="grid__col">
                          {{
                              onsList({
                                  "classes": 'list--bare list--inline@s u-mb-no',
                                  "items": row.items
                              })
                          }}
                      </div>
                      <div class="grid__col u-mt-m u-mb-m">
                          <hr class="footer__hr">
                      </div>
                  {% endfor %}
              {% endif %}
              {% if params.feedback %}
                  {% from "components/feedback/_macro.njk" import onsFeedback %}
                  <div class="grid__col col-8@m u-mb-s">
                      {{
                          onsFeedback({
                              "id": params.feedback.id | default("feedback"),
                              "action": params.feedback.action,
                              "title": params.feedback.title,
                              "closeButton": params.feedback.closeButton,
                              "closeButtonClasses": "btn--ghost-blue",
                              "textarea": params.feedback.textarea,
                              "name": params.feedback.name,
                              "email": params.feedback.email,
                              "sendButton": params.feedback.sendButton,
                              "thankYouMessage": params.feedback.thankYouMessage,
                              "errorMessage": params.feedback.errorMessage
                          })
                      }}
                  </div>
                  <div class="grid__col u-mb-m">
                      <hr class="footer__hr">
                  </div>
              {% endif %}
              <div class="grid__col">
                  <div class="footer__license">
                      <img alt="OGL" alt="OGL" class="footer__ogl-img" src="{{ '/' + params.version if params.version  }}/img/UKOpenGovernmentLicence-grey.svg">{{ params.OGLLink.pre}} <a href="{{ params.OGLLink.url }}" class="footer__link">{{ params.OGLLink.link }}</a>{{ params.OGLLink.post }}
                  </div>
              </div>
          </div>
      </div>
  </footer>
{% endmacro %}
