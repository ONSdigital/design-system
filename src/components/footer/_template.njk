{% from "components/lists/_macro.njk" import onsList %}

{% if params.lang %}
    {% set lang = params.lang %}
{% else %}
    {% set lang = 'en' %}
{% endif %}

{% if params.poweredByONS %}
    {% if params.poweredByONS.alt %}
        {% set poweredByAlt = params.poweredByONS.alt %}
    {% else %}
        {% set poweredByAlt = 'Office for National Statistics' %}
    {% endif %}
{% endif %}

<footer class="footer {{ params.classes }}" role="contentinfo">
    <div class="container">
        <div class="grid">
            {% if params.poweredByONS %}
                <div class="grid__col u-mb-m">
                    <img src="/img/ons-logo-black-{{ lang }}.svg" alt="{{ poweredByAlt }}" class="footer__poweredby-img">
                </div>
            {% endif %}
            {% if params.language %}
                {% set currentLanguage = params.language.languages | selectattr("current") | first %}
                <div class="grid__col u-d-no@s">
                    {% set languageItems = params.language.languages | rejectattr("current") %}
                    {% if currentLanguage.allLanguages and params.language.allLanguagesUrl %}
                        {% set languageItems = (languageItems.push({ 
                            "url": params.language.allLanguagesUrl,
                            "text": currentLanguage.allLanguages,
                            "lang": currentLanguage.ISOCode 
                        }), languageItems) %}
                    {% endif %}
                    {{
                        onsList({ 
                            "classes": 'footer__language list--bare',
                            "items": languageItems
                        })
                    }}
                </div>
            {% endif %}
            {% if params.cols %}
                {% for col in params.cols %}
                    <div class="grid__col col-4@m">
                        {% if col.title %}
                            <h4 class="u-fs-r--b footer__heading">{{ col.title }}</h4>
                        {% endif %}
                        {{
                            onsList({
                                "classes": 'list--bare',
                                "items": col.items
                            })
                        }}
                    </div>
                {% endfor %}
            {% endif %}
            {% if params.rows %}
                {% for row in params.rows %}
                    <div class="grid__col">
                        {{
                            onsList({
                                "classes": 'list--bare list--inline@s',
                                "items": row.items
                            })
                        }}
                    </div>
                {% endfor %}
            {% endif %}
            <div class="grid__col">
                <div class="footer__license footer__license--border">
                    <img alt="OGL" alt="OGL" class="footer__ogl-img" src="{{ '/' + params.version if params.version  }}/img/UKOpenGovernmentLicence-grey.svg">{{ params.OGLLink.pre}} <a href="{{ params.OGLLink.url }}" class="footer__link">{{ params.OGLLink.link }}</a>{{ params.OGLLink.post }}
                </div>
            </div>
        </div>
    </div>
</footer>
